# Check if PyTorch is available and import it
try:
    import torch
    print("✓ PyTorch is successfully imported!")
    print(f"PyTorch version: {torch.__version__}")

    # Check if CUDA is available
    if torch.cuda.is_available():
        device = torch.device("cuda") # <-- device 변수 정의 추가
        print(f"✓ CUDA is available! Device count: {torch.cuda.device_count()}")
        print(f"Current CUDA device: {torch.cuda.get_device_name(0)}")
    else:
        device = torch.device("cpu") # <-- device 변수 정의 추가
        print("CUDA is not available. Using CPU.")

    # Create a simple tensor to test basic functionality
    # *** 이 부분을 수정해야 합니다. 'device=device'를 추가합니다. ***
    test_tensor = torch.tensor([1, 2, 3, 4, 5], device=device) 
    
    print(f"✓ Test tensor created: {test_tensor}")
    print(f"Tensor shape: {test_tensor.shape}")
    print(f"Tensor device: {test_tensor.device}")

    # Basic tensor operation
    squared_tensor = test_tensor ** 2
    print(f"✓ Basic operation test (squaring): {squared_tensor}")

    print("\n✓ PyTorch is working correctly!")

except ImportError as e:
    print("❌ PyTorch is not installed or not available")
    print(f"Error details: {e}")
    print("Please install PyTorch using: pip install torch")

except Exception as e:
    print(f"❌ An error occurred while testing PyTorch: {e}")

✓ PyTorch is successfully imported!
PyTorch version: 2.8.0+cu126
✓ CUDA is available! Device count: 1
Current CUDA device: Tesla T4
✓ Test tensor created: tensor([1, 2, 3, 4, 5], device='cuda:0')
Tensor shape: torch.Size([5])
Tensor device: cuda:0
✓ Basic operation test (squaring): tensor([ 1,  4,  9, 16, 25], device='cuda:0')

✓ PyTorch is working correctly!
